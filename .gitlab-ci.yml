image: continuumio/miniconda3:latest

before_script:
#   - apt-get install -y cmake valgrind
  - apt-get update -q -y
  - apt-get install -y build-essential cppcheck
  - apt-get install -y libgl1-mesa-glx # conda opencv
  - conda info -a
  - conda env create -n test-environment -f env.yml
  - source activate test-environment
  - python --version
  - conda install flake8 pydocstyle pylint
  - pip install cpplint

stages:
  - Static Analysis
  - Test

flake8:
  stage: Static Analysis
  script:
    - make flake8

pylint:
  stage: Static Analysis
  script:
    - make pylint

pydocstyle:
  stage: Static Analysis
  script:
    - make pydocstyle

cppcheck:
  stage: Static Analysis
  script:
    - make cppcheck

cpplint:
  stage: Static Analysis
  script:
    - make cpplint

doctest:
  stage: Test
  script:
    - make doctest
